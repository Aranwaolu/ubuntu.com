{% extends "security/base_security.html" %}

{% block title %}{{ notice.id }}: {{ notice.title }} | Ubuntu security notices{% endblock %}

{% block content %}
  {% set breadcrumbs = [{"name": "Ubuntu Security Notices", "href": "/security/notices"}, {"name": notice.id }] %}
  {% include '/partial/_breadcrumbs.html' %}

  <section class="p-section--hero">
    <div class="row">
      <div class="col-start-large-4 col-9">
        <div class="p-section--shallow">
          <div class="row">
            <h1>{{ notice.id }}: {{ notice.title }}</h1>
          </div>
          <div class="row">
            <div class="col-2">
              <h5 class="u-no-margin--bottom">Publication date</h5>
            </div>
            <div class="col-7">
              <p class="u-no-margin--bottom">{{ notice.published }}</p>
            </div>
          </div>
          <div class="row">
            <div class="col-2">
              <h5 class="u-no-margin--bottom">Overview</h5>
            </div>
            <div class="col-7">
              <p class="u-no-margin--bottom">{{ notice.summary | safe }}</p>
            </div>
          </div>
          {% if notice.releases %}
            <div class="row">
              <div class="col-2">
                <h5 class="u-no-margin--bottom">Releases</h5>
              </div>
              <div class="col-7">
                {% for release in notice.releases %}
                  <a href="/security/notices?release={{ release.codename }}"
                    class="p-chip u-no-margin--bottom">
                    <span class="p-chip__value">{{ release.version }} {{ release.support_tag }}</span>
                  </a>
                {% endfor %}
              </div>
            </div>
          {% endif %}
        </div>
        <hr class="p-rule--muted" />
      </div>
    </div>
  </section>

  <section>
    <div class="row--25-75">
      <div class="col">
        <div class="p-side-navigation--raw-html is-sticky"
             id="drawer"
             style="top: 4rem">
          <a href="#drawer"
             class="p-side-navigation__toggle js-drawer-toggle"
             aria-controls="drawer">Toggle table of contents</a>

          <div class="p-side-navigation__overlay js-drawer-toggle"
               aria-controls="drawer"></div>

          <nav class="p-side-navigation__drawer" aria-label="Core case studies nav">
            <div class="p-side-navigation__drawer-header">
              <a href="#"
                 class="p-side-navigation__toggle--in-drawer js-drawer-toggle"
                 aria-controls="drawer">Toggle table of contents</a>
            </div>

            <ul>
              {% if notice.package_descriptions %}
                <li class="p-side-navigation__item">
                  <a class="highlight-link is-active" href="#description">Software description</a>
                </li>
              {% endif %}
              <li class="p-side-navigation__item">
                <a class="highlight-link" href="#details">Details</a>
              </li>
              <li class="p-side-navigation__item">
                <a class="highlight-link" href="#update-status">Checking update status</a>
              </li>
              {% if notice.cves_and_references %}
                <li class="p-side-navigation__item">
                  <a class="highlight-link" href="#references">References</a>
                </li>
              {% endif %}
            </ul>
          </nav>
        </div>
      </div>

      <div class="col">
        {% if notice.package_descriptions %}
          <div class="p-section">
            <div class="row">
              <h2 class="tab-heading" id="description" style="scroll-margin-top: 4rem">Software description</h2>
              <div class="col-7">
                <ul class="p-list">
                  {% for package_name, package_title in notice.package_descriptions.items() %}
                    <li class="p-list__item has-bullet">
                      <strong>{{ package_name }}</strong> - {{ package_title }}
                    </li>
                  {% endfor %}
                </ul>
              </div>
            </div>
          </div>
        {% endif %}

        <div class="p-section">
          <div class="row">
            <h2 class="tab-heading" id="details" style="scroll-margin-top: 4rem">Details</h2>
            <div class="js-details-truncated">
              <p>{{ notice.details | truncate(1000) | safe }}</p>
            </div>
            <div class="js-details-all u-hide">
              <p>{{ notice.details | safe }}</p>
            </div>
          </div>
          {% if notice.details | length > 1000 %}
            <hr class="p-rule--muted" />
            <button class="p-button--link js-show-details">Show more</button>
          {% endif %}
        </div>

        <div class="p-section">
          <div class="row">
            <h2 class="tab-heading" id="update-status" style="scroll-margin-top: 4rem">Checking update status</h2>
            <div class="p-notification--information">
              <div class="p-notification__content">
                <p class="p-notification__message">
                  <p>To check your kernel type and Livepatch version, enter this command:<br /></p>
                  <div class="p-code-snippet u-no-margin--bottom">
                    <pre class="p-code-snippet__block--icon"><code>canonical-livepatch status</code></pre>
                  </div>
                </p>
              </div>
            </div>
            <p>The problem can be corrected in these Livepatch versions:</p>
            <table>
              <thead>
                <th>Kernel type</th>
                {% for version in notice.release_packages.__reversed__() %}
                  <th>{{ version }}</th>
                {% endfor %}
              </thead>
              <tbody>
                {% for package_name in notice.package_descriptions.keys() %}
                  <tr>
                    <td><strong>{{ package_name }}</strong></td>
                    {% for version in notice.release_packages.__reversed__() %}
                      {% if notice.release_packages[version][package_name] %}
                        <td>{{ notice.release_packages[version][package_name].version }}</td>
                      {% else %}
                        <td>&mdash;</td>
                      {% endif %}
                    {% endfor %}
                  </tr>
                {% endfor %}
              </tbody>
            </table>
          </div>
        </div>

        {% if notice.cves_and_references %}
          <div class="u-fixed-width">
            <h2 class="tab-heading" id="references" style="scroll-margin-top: 4rem">References</h2>
          </div>
          {% if notice.cves_and_references | length > 29 %}
            <form action="/security/notices/{{ notice.id }}#references" method="GET" class="p-form js-form">
              <div class="row u-equal-height">
                <div class="col-8">
                  <div class="row">
                    <div class="col-7">
                      <label class="p-form__label" for="cve">CVE ID contains</label>
                      <input class="p-form__control"
                              type="text"
                              name="cve"
                              id="cve"
                              value="{{ request.args.get('cve', '') }}" />
                    </div>
                    <div class="col-2 u-align--right"
                          style="display: flex;
                                align-items: flex-end">
                      <button type="submit" class="p-button--positive js-submit" style="width:100%">
                        Search
                        {% if search %}again{% endif %}
                      </button>
                    </div>
                  </div>
                </div>
              </div>
            </form>
          {% endif %}
          <div class="p-section">
            <div class="row">
              <div class="col-8">
                <ul class="p-list js-references-truncated">
                  {% set ns = namespace(counter=0) %}
                  {% if notice.cves_and_references %}
                    {% for reference in notice.cves_and_references %}
                      {% if ns.counter < 10 %}
                        {% if "CVE-" in reference.id %}
                          <li class="p-list__item">
                            <a href="/security/{{ reference.id }}">{{ reference.id }}</a>
                          </li>
                        {% else %}
                          <li class="p-list__item">
                            <a href="{{ reference }}">{{ reference }}</a>
                          </li>
                        {% endif %}
                        {% set ns.counter = ns.counter + 1 %}
                      {% endif %}
                    {% endfor %}
                  {% endif %}
                </ul>
                <ul class="p-list js-references-all u-hide">
                  {% if notice.cves_and_references %}
                    {% for cve in notice.cves_and_references %}
                      {% if "CVE-" in cve.id %}
                        <li class="p-list__item">
                          <a href="/security/{{ cve.id }}">{{ cve.id }}</a>
                        </li>
                      {% else %}
                        <li class="p-list__item">
                          <a href="{{ reference }}">{{ reference }}</a>
                        </li>
                      {% endif %}
                    {% endfor %}
                  {% endif %}
                </ul>
              </div>
            </div>
          </div>
          <div class="u-fixed-width">
            {% if notice.cves_and_references | length > 10 %}
              <hr class="p-rule--muted" />
              <button class="p-button--link js-show-references">Show {{ notice.cves_and_references | length - 10 }} more references</button>
            {% endif %}
          </div>
        {% endif %}
      </div>
    </div>
  </section>

  <hr class="p-rule is-fixed-width" />
  <section class="p-strip is-deep">
    <div class="u-fixed-width">
      <div class="p-heading--2">
        <p>Have additional questions?</p>
        <a href="https://wiki.ubuntu.com/SecurityTeam/FAQ?_ga=2.242131138.1744859116.1742138161-1500419473.1726851136&_gl=1*161muja*_gcl_au*MzUyMTIzNjI1LjE3MzYyNDQ4NTE.#Contact">Talk to a member of the team&nbsp;&rsaquo;</a>
      </div>
    </div>
  </section>




<section class="p-strip">
  
  {% if notice.cves or notice.references %}
  <div class="row">
    <div class="col-8">
      <h2>References</h2>
      <ul class="p-list">
        {% if notice.cves %}
          {% for cve in notice.cves %}
            <li class="p-list__item"><a href="/security/{{ cve.id }}">{{ cve.id }}</a></li>
          {% endfor %}
        {% endif %}

        {% if notice.references %}
          {% for reference in notice.references %}
            <li class="p-list__item"><a href="{{ reference }}">{{ reference }}</li>
          {% endfor %}
        {% endif %}
      </ul>
    </div>
  </div>
  {% endif %}
</section>

<script>
    function setUpDynamicSideNav() {
      const questions = Array.prototype.slice.call(
        document.querySelectorAll(".tab-heading")
      );

      const navigationLinks = Array.prototype.slice.call(
        document.querySelectorAll(".highlight-link")
      );

      questions.forEach(function(question) {
        const observer = new IntersectionObserver(function(entry) {
          if (entry[0].isIntersecting) {
            const questionId = entry[0].target.id;
            navigationLinks.forEach(function(link) {
              if (link.getAttribute("href") === `#${questionId}`) {
                link.classList.add("is-active");
              } else {
                link.classList.remove("is-active");
              }
            });
          }
        }, {
          rootMargin: "-200px 0px -400px",
          threshold: 0.5,
        });

        observer.observe(question);
      });
    };

    function toggleShowMore(showSection) {
      const truncated = document.querySelector(`.js-${showSection}-truncated`);
      const all = document.querySelector(`.js-${showSection}-all`);
      const showMoreButton = document.querySelector(`.js-show-${showSection}`);

      showMoreButton.addEventListener("click", function() {
        truncated.classList.add("u-hide");
        all.classList.remove("u-hide");
        showMoreButton.classList.add("u-hide");
      });
    }

    (function() {
      setUpDynamicSideNav();
      toggleShowMore("details");
    })();
  </script>

{% endblock %}
